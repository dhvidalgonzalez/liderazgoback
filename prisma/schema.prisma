generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  rut       String   @unique
  name      String
  email     String   @unique
  password  String
  role      Role     @default(USER)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relaciones
  createdJustifications  Justification[] @relation("CreatedBy")
  reviewedJustifications Justification[] @relation("ReviewedBy")
}

model Justification {
  id                String              @id @default(uuid())

  // Datos est치ticos del trabajador justificado
  employeeName      String
  employeeRut       String
  employeeEmail     String
  employeeSapCode   String?            // Opcional
  employeeGerencia  String?            // Opcional

  // Informaci칩n de la justificaci칩n
  startDate         DateTime
  endDate           DateTime
  type              JustificationType
  description       String?
  documentUrl       String?
  status            JustificationStatus @default(PENDING)
  reviewedAt        DateTime?

  // Usuario que crea la justificaci칩n (requiere login)
  creatorId         String
  creator           User                @relation("CreatedBy", fields: [creatorId], references: [id])

  // Usuario revisor (opcional)
  reviewerId        String?
  reviewer          User?               @relation("ReviewedBy", fields: [reviewerId], references: [id])
  reviewerCause     String?
  reviewerComment   String?

  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
}



enum Role {
  USER
  ADMIN
}

enum JustificationStatus {
  PENDING
  APPROVED
  REJECTED
}

enum JustificationType {
  VACATION
  COMISION
  ACTIVIDAD
  MEDICAL
  LEGAL
  OTHER
}
